UIView背后关联的图层是真正用来在屏幕上显示和做动画。UIView仅仅是对它的封装，提供iOS类似于处理触摸的具体功能，以及Core Animation底层方法的高级接口。

视图层级  图层树  呈现树  渲染树

Layer的功能

* 阴影，圆角，带颜色的边框

* 3D变换

* 非矩形范围

* 透明遮罩

* 多级非线性动画

---

点就像是虚拟的像素，也被称为逻辑像素，

---
CALayer有一个可选的delegate属性，实现CALayerDelegate协议，当CALayer需要一个内容特定的信息时，就会从协议中请求。
“当UIView创建了它的宿主图层时，它就会自动地把图层的delegate设置为它自己，并提供了一个-displayLayer:的实现”

```
(lldb) po self.view
<UIView: 0x7fcdfa305c70; frame = (0 0; 414 736); autoresize = W+H; layer = <CALayer: 0x6000000251e0>>

(lldb) po self.view.layer
<CALayer:0x6000000251e0; position = CGPoint (207 368); bounds = CGRect (0 0; 414 736); delegate = <UIView: 0x7fcdfa305c70; frame = (0 0; 414 736); autoresize = W+H; layer = <CALayer: 0x6000000251e0>>; sublayers = (<CALayer: 0x600000025460>); allowsGroupOpacity = YES; backgroundColor = <CGColor 0x6000000b1100> [<CGColorSpace 0x6080000b1b20> (kCGColorSpaceICCBased; kCGColorSpaceModelRGB; sRGB IEC61966-2.1; extended range)] ( 1 1 1 1 )>

(lldb) po self.view.layer.delegate
<UIView: 0x7fcdfa305c70; frame = (0 0; 414 736); autoresize = W+H; layer = <CALayer: 0x6000000251e0>>

(lldb) 

```

UIView的center对应CALayer的position；两个对应的属性都对应了相对于父视图层anchorPoint所在的位置。


当对图层做变换的时候，例如旋转或者缩放，frame实际上代表了覆盖在图层旋转之后的整个轴对齐的矩形区域，这时，frame的宽高可能就会bounds的宽高不一样了。

图层的anchorPoint用单位坐标来描述。默认坐标是{0.5,0.5}

zposition属性用来改变图层的显示顺序，但不能改变事件的传递顺序。

conrnerRadius这个属性只影响背景颜色，不会影响背景图片或是子图层。masksToBounds设置为YES的话，图层里边的所有东西都会被截取。

图层的边框是绘制在图层边界里边的。而且在所有字内容之前，也就是在子图层之前。边框会在寄宿图和子图层的上边。

“和图层边框不同，图层的阴影继承自内容的外形，而不是根据边界和角半径来确定。为了计算出阴影的形状，Core Animation会将寄宿图（包括子视图，如果有的话）考虑在内，然后通过这些来完美搭配图层形状从而创建一个阴影”

mask属性就像是一个饼干切割机，mask图层实心的部分会被保留下来，其他的则会被抛弃。

view.layer.magnificationFilter = kCAFilterNearest;放大
minificationFilter缩小
kCAFilterLinear 二线性过滤
kCAFilterNearest 最近过滤
kCAFilterTrilinear 三线性过滤
“线性过滤保留了形状，最近过滤则保留了像素的差异。

CALayer的doubleSided属性来





















































































































































































































































































































































































